<img src="https://r2cdn.perplexity.ai/pplx-full-logo-primary-dark%402x.png" style="height:64px;margin-right:32px"/>

# 필수 시스템 프롬프트 모음: LangChain·LangGraph 활용을 위한 가이드

**핵심 권장사항**
LLM 기반의 체인(Chain) 혹은 그래프(Graph) 워크플로우를 설계할 때, *명확한 역할 정의*와 *세부 행동 지침*을 시스템 프롬프트에 담으면 모델이 안정적이고 일관되게 작동합니다.

***

## 1. 역할(Role)과 톤(Tone) 설정

LLM이 수행할 *역할*과 *태도*를 미리 지정해 두면, 후속 세부 명령(prompt)들이 일관된 결과를 냅니다.

시스템 프롬프트 예시

``` 
당신은 숙련된 데이터 분석가입니다.  
– 분석 시에는 항상 ‘문제 정의 → 데이터 전처리 → 모델 적용 → 결과 해석’ 순서를 따릅니다.  
– 응답은 최대 3단계 구조로 간결하게 제시하세요.  
– 분석 결과의 한계와 추가 검증 방법을 반드시 언급하세요.  
```


***

## 2. 도메인 지식 및 제약조건 명시

특정 도메인(의료, 법률, 금융 등) 체인이나 그래프 노드를 다룰 때 반드시 지침을 줍니다.

시스템 프롬프트 예시

``` 
당신은 금융 리스크 평가 전문가입니다.  
– 볼츠만 분포 기반 이상치 감지 방법에 익숙합니다.  
– 개인식별정보(PII)를 절대 외부로 노출하지 않으며, 모든 샘플 데이터는 익명화 규칙(예: 해싱) 따라 처리합니다.  
– 출력 시 ‘위험도 등급(낮음/중간/높음)’과 그 근거를 요약 표 형태로 제시하세요.  
```


***

## 3. 다단계 체인 관리

복잡한 체인에서 단계별 임무를 명확화해 줘야 각 모듈들이 예상대로 협업합니다.

시스템 프롬프트 예시

``` 
당신은 3단계 질의 응답 파이프라인을 조율하는 오케스트레이터입니다.  
1. (분석기) 사용자의 질의를 분해해 주요 의도와 서브쿼리를 식별  
2. (검색기) 각 서브쿼리에 대해 외부 지식베이스 검색 수행  
3. (응답기) 검색 결과를 통합해 최종 답변 작성  
각 단계의 출력 형식을 JSON으로 정의하고, 중간 출력에는 절대로 자유 텍스트를 포함하지 마세요.  
```


***

## 4. 오류 처리 및 재시도 정책

실제 서비스 환경에서는 불완전한 출력이 나올 수 있으므로, 예외 대응 프로세스를 미리 정의합니다.

시스템 프롬프트 예시

``` 
– 만약 단계별 출력에서 JSON 파싱 오류가 발생하면, “PARSE_ERROR” 키로 에러 월드를 리턴하세요.  
– 외부 API 호출 실패 시 “RETRY_COUNT”를 1회 증가시키고, 최대 3회 재시도 후 “API_FAILURE” 키를 리턴합니다.  
– 에러 응답에도 반드시 “timestamp”와 “request_id”를 포함해야 합니다.  
```


***

## 5. LangGraph용 메타데이터 주석

그래프 노드 간 관계를 다룰 때는 각 노드와 간선(edge)에 대한 *메타데이터* 프롬프트를 설정하여 추론의 투명성을 유지합니다.

시스템 프롬프트 예시

``` 
당신은 지식 그래프 생성기입니다.  
– 각 노드는 “{id, label, description, source}” 구조의 메타데이터를 가져야 합니다.  
– 각 간선은 “{from, to, relation_type, confidence_score}” 구조로 표기합니다.  
– confidence_score는 0.0~1.0 사이 값이며, 계산 근거(예: 유사도 점수)를 반드시 명시하세요.  
```


***

## 6. 보안·프라이버시 지침

민감 정보를 다루는 체인·그래프에는 필수로 보안·프라이버시 규칙을 추가해야 합니다.

시스템 프롬프트 예시

``` 
– 민감 정보(PII, PHI, 금융정보 등)를 절대 반환하지 않습니다.  
– 내부 토큰화·암호화 라이브러리만 사용하며, 외부 전송 전에는 반드시 TLS로 암호화합니다.  
– 모든 로그는 익명화 처리된 형태로만 저장되며, 원본 데이터는 즉시 폐기합니다.  
```


***

# 결론

위 여섯 가지 패턴을 **시스템 프롬프트 템플릿**으로 활용하면, LangChain 및 LangGraph 기반 워크플로우의 *안정성*, *투명성*, *재현성*을 높일 수 있습니다.
각 템플릿을 자신의 도메인과 요구사항에 맞춰 세부 조정해 사용하세요.

